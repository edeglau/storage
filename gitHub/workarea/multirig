
meshName=pm.ls(sl=1, fl=1)
mainMesh=[(each) for each in meshName if pm.PyNode(each).nodeType()=="mesh"]
getDriverObjects=[(each) for each in meshName if pm.PyNode(each).nodeType()=="transform"]
try:
	getDriverObjects=[(each) for each in cmds.listRelatives(getDriverObjects, c=1) if pm.PyNode(each).nodeType()=="transform"]	
except:
	getDriverObjects=getDriverObjects
grabItems=[]
getSurfaceObj=pm.PyNode(mainMesh[0]).node()
getParentModelTransform=pm.listRelatives(getSurfaceObj, p=1, typ="transform")[0]
grabDriverPoints=[(item) for item in pm.PyNode(each).vtx for each in getDriverObjects]
pm.select(cl=1)
getRigGrp=pm.group(n=str(getSurfaceObj)+"_Rigs")
pm.select(cl=1)
getRigLocGrp=pm.group(n=str(getSurfaceObj)+"_Locs")
pm.PyNode(getRigLocGrp).visibility.set(0)
pm.select(cl=1)
getRigJntGrp=pm.group(n=str(getSurfaceObj)+"_Jnts")
pm.PyNode(getRigJntGrp).visibility.set(0)
pm.select(cl=1)
getRigCtrlGrp=pm.group(n=str(getSurfaceObj)+"_Ctrl")
pm.select(cl=1)
pm.parent(getRigJntGrp, getRigGrp)
pm.parent(getRigLocGrp, getRigGrp)
pm.parent(getRigCtrlGrp, getRigGrp)
for each in getDriverObjects:
    for grabDriverPoints in pm.PyNode(each).vts:
        grabItems.append(grabDriverPoints)
for leadVert in getDriverObjects:
	rotLocName=leadVert.split(".")[0]+"_"+str(leadVert.index())+"_rloc"
	getrotNew=pm.spaceLocator(n=rotLocName)
	pm.normalConstraint(leadVert, rotLocName)
	rotate=pm.xform(rotLocName, q=1, ws=1, ro=1)
	pm.delete(getrotNew)
	transformWroldMatrix=leadVert.getPosition('world')
	plocName=leadVert.split('.')[0]+"_"+str(leadVert.index())+"_ploc"
    grabDriverPoints=[(eachpoint) for eachpoint in grabItems if transformWroldMatrix==eachpoint.getPosition("world")]
    getUVmap = polyListComponentConversion(leadVert, fv=1, tuv=1)
    getCoords=polyEditUV(getUVmap, q=1)
    plocName=leadVert.split(".")[0]+"_"+str(leadVert.index())+"_ploc"
    getNew=spaceLocator(n=plocName)
    
    select(leadVert, r=1)
    select(getNew[0], add=1)
    buildConst=pointOnPolyConstraint(leadVert, getNew, mo=0, offset=(0.0, 0.0, 0.0))
    setAttr(buildConst[0]+"."+getObj+"U0", getCoords[0])
    setAttr(buildConst[0]+"."+getObj+"V0", getCoords[1])   
    select(cl=1)
    jointName=str(grabDriverPoints[0].split(".")[0]+"_"+str(leadVert.index())+"_jnt"
    getjoint=joint(n=jointName)
    xform(jointName, ws=1, t=leadVert.getPosition("world"))
    parent(getjoint, getNew)
    getMeshName=grabDriverPoints[0].node()
    skinCluster(jointName, getMeshName)
